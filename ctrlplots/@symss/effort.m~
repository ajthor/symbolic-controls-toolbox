function [t, y] = effort(sys, u, varargin)
%EFFORT Compute the control effort of a system to arbitrary inputs.
%   
%   [t, y] = EFFORT(sys, u, t) computes the control effort of a system.


T = sym('t');

[ts, ys] = nlsim(sys, u, varargin{:});

[tx, ~, ~, ~] = varsub(sys);
Ufun = symfun(subs(u, sys.states, tx), [T; tx]);

odefun = matlabFunction(Ufun, 'Vars', {T, tx});

% TT = ts{:};
% YY = ys{:};
% for k = 1:numel(ts)
%     [t(k), y(k)] = odefun(TT(k), YY(k, :).');
% end
[t, y] = odefun(ts{:}.', ys{:}.');

if nargout == 0
    plot(t, y)
    
end

% [t, y] = ode45(odefun, varargin{1}, varargin{2});

% if nargout == 0
%     [ts, ys] = 
% else
%     [ts, ys] = nlsim(T, u, varargin{:});
% end

end

